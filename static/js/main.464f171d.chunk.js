(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{30:function(e,t,n){e.exports=n(43)},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(26),s=n.n(o),i=n(4),c=n(5),u=n(2),l=n(8),d=n(7),p=n(14),m=n(16),h=n(10),v=n(1),f=n.n(v),b=n(6),g=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,null,[{key:"register",value:function(e){function t(){return(t=Object(b.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://ing-invoicing.herokuapp.com/api/ing-users",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){return t.apply(this,arguments)}()}},{key:"login",value:function(e){function t(){return(t=Object(b.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://ing-invoicing.herokuapp.com/api/ing-users/login",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){return t.apply(this,arguments)}()}},{key:"logOut",value:function(e){function t(){return(t=Object(b.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://ing-invoicing.herokuapp.com/api/ing-users/logout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return n=t.sent,t.next=5,n;case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){return t.apply(this,arguments)}()}},{key:"getCustomers",value:function(e){function t(){return(t=Object(b.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://ing-invoicing.herokuapp.com/api/customers",{method:"GET",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){return t.apply(this,arguments)}()}},{key:"getProducts",value:function(e){function t(){return(t=Object(b.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://ing-invoicing.herokuapp.com/api/products",{method:"GET",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){return t.apply(this,arguments)}()}},{key:"getInvoices",value:function(e){function t(){return(t=Object(b.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices",{method:"GET",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){return t.apply(this,arguments)}()}},{key:"setInvoice",value:function(e,t){function n(){return(n=Object(b.a)(f.a.mark((function n(){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:e}});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}()}},{key:"setItemToInvoice",value:function(e,t){function n(){return(n=Object(b.a)(f.a.mark((function n(){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices/"+t.invoiceId+"/items",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:e}});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}()}},{key:"getItemsOfInvoice",value:function(e,t){function n(){return(n=Object(b.a)(f.a.mark((function n(){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices/"+t+"/items",{method:"GET",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}()}},{key:"getInvoiceById",value:function(e,t){function n(){return(n=Object(b.a)(f.a.mark((function n(){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices/"+t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}()}},{key:"getCustomerById",value:function(e,t){function n(){return(n=Object(b.a)(f.a.mark((function n(){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://ing-invoicing.herokuapp.com/api/customers/"+t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}()}},{key:"deleteInvoiceById",value:function(e,t){function n(){return(n=Object(b.a)(f.a.mark((function n(){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices/"+t,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}()}},{key:"updateInvoiceById",value:function(e,t,n){function a(){return(a=Object(b.a)(f.a.mark((function a(){var r;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices/"+t,{method:"PATCH",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:e}});case 2:return r=a.sent,a.next=5,r.json();case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return function(){return a.apply(this,arguments)}()}},{key:"updateItemById",value:function(e,t,n,a){function r(){return(r=Object(b.a)(f.a.mark((function r(){var o;return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices/"+t+"/items/"+n,{method:"PUT",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Authorization:e}});case 2:return o=r.sent,r.next=5,o.json();case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return function(){return r.apply(this,arguments)}()}},{key:"deleteItemById",value:function(e,t,n){function a(){return(a=Object(b.a)(f.a.mark((function a(){var r;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("https://ing-invoicing.herokuapp.com/api/invoices/"+t+"/items/"+n,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:e},mode:"cors",cache:"default"});case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return function(){return a.apply(this,arguments)}()}}]),e}(),y=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state=void 0,a.props=void 0,a.handleInputs=a.handleInputs.bind(Object(u.a)(a)),a.login=a.login.bind(Object(u.a)(a)),a.state={userData:{email:"",password:""},error:""},a}return Object(c.a)(n,[{key:"login",value:function(e){var t=this;e.preventDefault();for(var n=0,a=Object.keys(this.state.userData);n<a.length;n++){var r=a[n];if(""===this.state.userData[r])return}g.login(this.state.userData).then((function(e){e.error?t.setState({error:e.error.message}):t.props.stateHandler({isAuth:!0,userId:e.userId,accessToken:e.id})})).catch((function(e){return new Error(e)}))}},{key:"handleInputs",value:function(e){this.setState({userData:Object(m.a)(Object(m.a)({},this.state.userData),{},Object(p.a)({},e.target.name,e.target.value))})}},{key:"render",value:function(){return r.a.createElement("div",{className:"section home-bg"},r.a.createElement("div",{className:"row register-block bg-forms rounded text-white text-center justify-content-center p-4"},r.a.createElement("form",null,r.a.createElement("h1",{className:"text-center"},"Login"),r.a.createElement("div",{className:"text-danger"},this.state.error),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"login-email"},"Email"),r.a.createElement("input",{type:"email",className:"form-control",id:"login-email",name:"email",onChange:this.handleInputs,value:this.state.userData.email}))),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"login-password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"login-password",name:"password",onChange:this.handleInputs,value:this.state.userData.password})))),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col"},r.a.createElement("button",{type:"submit",className:"btn btn-fish btn-block",onClick:this.login},"Sign in \u26a1")),r.a.createElement("div",{className:"col ml-2"},r.a.createElement(h.b,{to:"/register",className:"text-decoration-none"},r.a.createElement("button",{type:"button",className:"btn btn-edit-btn btn-block"},"Register")))))))}}]),n}(r.a.Component),I=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state=void 0,a.props=void 0,a.handleInputs=a.handleInputs.bind(Object(u.a)(a)),a.register=a.register.bind(Object(u.a)(a)),a.state={name:"",email:"",username:"",password:"",dob:""},a}return Object(c.a)(n,[{key:"handleInputs",value:function(e){var t;this.setState((t={},Object(p.a)(t,e.target.name,e.target.value),Object(p.a)(t,"dob",(new Date).toUTCString()),t))}},{key:"register",value:function(e){var t=this;e.preventDefault();for(var n=0,a=Object.keys(this.state);n<a.length;n++){var r=a[n];if(""===this.state[r])return}g.register(this.state).then((function(e){t.setState({userId:e.id}),t.props.history.goBack()})).catch((function(e){return new Error(e)}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"section home-bg"},r.a.createElement("div",{className:"row register-block bg-forms rounded text-white text-center justify-content-center p-4"},r.a.createElement("form",null,r.a.createElement("h1",{className:"text-center"},"Register"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg col-md-6 col-sm-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"register-name"},"Name"),r.a.createElement("input",{type:"text",className:"form-control",id:"register-name",name:"name",onChange:this.handleInputs,value:this.state.name}))),r.a.createElement("div",{className:"col-lg-6 col-md-6 col-sm-12"},r.a.createElement("div",{className:"form-group ml-2 ml-sm-0"},r.a.createElement("label",{htmlFor:"register-username"},"User name"),r.a.createElement("input",{type:"text",className:"form-control",id:"register-username",name:"username",onChange:this.handleInputs,value:this.state.username})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-12 col-md-6 col-sm-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"register-email"},"Email"),r.a.createElement("input",{type:"email",className:"form-control",id:"register-email",name:"email",onChange:this.handleInputs,value:this.state.email}))),r.a.createElement("div",{className:"col-lg-12 col-md-6 col-sm-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"register-password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"register-password",name:"password",onChange:this.handleInputs,value:this.state.password})))),r.a.createElement("div",{className:"row justify-content-center text-center"},r.a.createElement("div",{className:"col-6"},r.a.createElement("button",{type:"submit",className:"btn btn-fish btn-block",onClick:this.register},"Sign up \u26a1")),r.a.createElement("div",{className:"col-6"},r.a.createElement(h.b,{to:"/login",className:"text-decoration-none"},r.a.createElement("button",{type:"button",className:"btn btn-edit-btn btn-block"},"Sign in")))))))}}]),n}(r.a.Component),E=function(e){var t={pathname:e.editInvoiceProps.pathname,state:Object(m.a)(Object(m.a)({},e.editInvoiceProps.state),{},{invoiceData:e.invoiceData})};return r.a.createElement("div",{className:"bg-list-item rounded text-white mb-2 list-item"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"row p-2 justify-content-between align-items-center"},r.a.createElement("div",{className:"col-lg-3 col-md-4 col-sm-12 col-xs-12 "},r.a.createElement("div",{className:"row"},e.invoiceData.customerName),r.a.createElement("div",{className:"row text-half-white"},"#ID\xa0-\xa0",e.invoiceData.invoiceId)),r.a.createElement("div",{className:"col-lg-2 col-md-1 col"},"Discount: ",e.invoiceData.discount,"%"),r.a.createElement("div",{className:"col-lg-2 col-md-1 col"},"Total: ",e.invoiceData.total),r.a.createElement("div",{className:"col-lg-2 col-md-2 col"},r.a.createElement("div",{className:"row justify-content-end "},r.a.createElement(h.b,{to:t},r.a.createElement("button",{className:"btn btn-edit-btn text-white"},"edit")),r.a.createElement("button",{className:"btn btn-home-delete ml-2",onClick:function(t){t.preventDefault(),e.initHandler(e.invoiceData.invoiceId)}},"del"))))))},k=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).props=void 0,a.state=void 0,a.getAPI=a.getAPI.bind(Object(u.a)(a)),a.initHandler=a.initHandler.bind(Object(u.a)(a)),a.state={invoices:[],init:!1},a}return Object(c.a)(n,[{key:"getAPI",value:function(){var e=this;g.getInvoices(this.props.userData.accessToken).then((function(t){g.getCustomers(e.props.userData.accessToken).then((function(n){var a=[];t.forEach((function(t){if(t.createdById===e.props.userData.userId){var r=n.filter((function(e){return t.customerId===e.id}))[0],o={invoiceId:t.id,total:t.total,discount:t.discount,customerId:t.customerId,customerName:r.name};a.push(o)}})),e.setState({invoices:a,init:!0})}))}))}},{key:"setInvoicesItems",value:function(){var e=this,t=[];return this.state.invoices.forEach((function(n){var a=r.a.createElement(E,{key:n.invoiceId,invoiceData:n,initHandler:e.initHandler,editInvoiceProps:e.props.editInvoiceProps});t.push(a)})),t}},{key:"initHandler",value:function(e){var t=this;g.deleteInvoiceById(this.props.userData.accessToken,e).then((function(n){var a=t.state.invoices.filter((function(t){return t.invoiceId!==e}));t.setState({invoices:a})}))}},{key:"render",value:function(){return this.state.init||this.getAPI(),r.a.createElement("div",{className:"col-lg-9 col-md-9 col-sm-12 col-xs-11 p-2 invoices-list"},this.state.invoices.length?this.setInvoicesItems():!0===this.state.init?r.a.createElement("h1",{className:"text-center h2 mt-4"},"You don't have invoices yet."):"")}}]),n}(r.a.Component),j=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).props=void 0,a.logOut=a.logOut.bind(Object(u.a)(a)),a}return Object(c.a)(n,[{key:"logOut",value:function(e){var t=this;e.preventDefault(),g.logOut(this.props.userData.accessToken).then((function(e){e.ok?t.props.stateHandler({isAuth:!1,userId:"",accessToken:""}):console.error("Invalid access token")})).catch((function(e){return new Error(e)}))}},{key:"render",value:function(){var e={pathname:"/add-edit-invoice",state:{mode:"add",token:this.props.userData.accessToken,userId:this.props.userData.userId}},t={pathname:"/add-edit-invoice",state:{mode:"edit",token:this.props.userData.accessToken,userId:this.props.userData.userId}};return r.a.createElement("div",{className:"home-page"},r.a.createElement("div",{className:"row content-home"},r.a.createElement("div",{className:"col-lg-2 col-md-2 col-sm-12 mh-100 bg-aside aside-content"},r.a.createElement("h2",{className:"m-3 text-white text-center logo"},"Wolf \u262a Inc."),r.a.createElement("div",{className:"col d-flex flex-column justify-content-between text-center",style:{height:"85%"}},r.a.createElement(h.b,{to:e},r.a.createElement("button",{className:"btn btn-add-btn mt-3 border-white add-btn w-100"},"Add invoice")),r.a.createElement("button",{className:"btn btn-log-out border-secondary log-out",onClick:this.logOut},"Log out")))),r.a.createElement(k,{userData:this.props.userData,editInvoiceProps:t}))}}]),n}(r.a.Component),N=n(19),O=function(e){var t=e.customerId?e.customerId:e.invoiceData!=={}&&e.invoiceData.customerId;return r.a.createElement("div",{className:"col-12 text-left"},r.a.createElement("label",{htmlFor:"add-customer"},"Customer"),r.a.createElement("select",{className:"form-control",id:"add-customer",onChange:function(t){t.preventDefault(),e.customerHandler(t.target.value)},value:t},r.a.createElement("option",{value:"none"},"Select customer"),function(){var t=[];return e.customers.forEach((function(e,n){var a=r.a.createElement("option",{key:n,value:e.id},e.name+" ---  Address: "+e.address);t.push(a)})),t}()))},w=n(29),x=function(e){var t=Object(a.useState)("none"),n=Object(w.a)(t,2),o=n[0],s=n[1];return r.a.createElement("div",{className:"row mb-3"},r.a.createElement("div",{className:"col-12 text-left"},r.a.createElement("label",{htmlFor:"add-product"},"Product")),r.a.createElement("div",{className:"col-lg-8 col-md-8 col-sm-12"},r.a.createElement("select",{className:"form-control",id:"add-product",onChange:function(e){s(e.target.value)}},r.a.createElement("option",{value:"none"},"Select product"),function(){var t=[];return e.products.forEach((function(e,n){var a=r.a.createElement("option",{key:n,value:e.id},e.name+" --- "+e.price+"$");t.push(a)})),t}())),r.a.createElement("div",{className:"col-lg-4 col-md-4 col-sm-12 text-right add-product-btn"},r.a.createElement("button",{className:"btn btn-add-product",onClick:function(t){t.preventDefault(),"none"!==o&&e.addProductHandler(o)}},"Add product")))},D=function(e){return r.a.createElement("div",{className:"col-12 mb-2"},r.a.createElement("div",{className:"product d-flex justify-content-between align-items-center p-1 bg-product text-dark rounded"},r.a.createElement("div",{className:"col-4"},e.product.name),r.a.createElement("div",{className:"col-2 d-flex justify-content-between"},r.a.createElement("input",{className:"w-100 bg-product",type:"number",id:"quantity",value:e.itemOptions.quantity,onChange:function(t){t.preventDefault(),e.quantityHandler(t,e.itemOptions.uniqId)}})),r.a.createElement("div",{className:"col-4"},"Prices: ",e.itemOptions.totalPrice.toFixed(2)+"$"),r.a.createElement("div",{className:"col-2"},r.a.createElement("button",{className:"btn-sm btn-delete",onClick:function(t){t.preventDefault(),e.deleteProductHandler(e.itemOptions.uniqId)}},"del \ud83d\uddd1"))))},P=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).props=void 0,a.state=void 0,a.pageMod=void 0,a.customerHandler=a.customerHandler.bind(Object(u.a)(a)),a.addProductHandler=a.addProductHandler.bind(Object(u.a)(a)),a.deleteProductHandler=a.deleteProductHandler.bind(Object(u.a)(a)),a.quantityHandler=a.quantityHandler.bind(Object(u.a)(a)),a.discountHandler=a.discountHandler.bind(Object(u.a)(a)),a.addInvoice=a.addInvoice.bind(Object(u.a)(a)),a.pageMod=e.pageMod,a.state={customer:"",products:[],discount:0,totalInvoicePrice:0},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setTotalInvoicePrice()}},{key:"componentDidUpdate",value:function(){this.state.products.length?this.setTotalInvoicePrice():this.state.totalInvoicePrice>0&&this.setState({totalInvoicePrice:0})}},{key:"setTotalInvoicePrice",value:function(){if(this.state.products.length){var e=this.state.products.reduce((function(e,t){return e+t.totalPrice}),0);this.state.discount>0&&(e-=e/100*this.state.discount),e=e.toFixed(2),this.state.totalInvoicePrice!==e&&this.setState({totalInvoicePrice:e})}else this.setState({totalInvoicePrice:0})}},{key:"customerHandler",value:function(e){var t=this;if("add"===this.pageMod)this.setState({customer:e});else{var n={customerId:e};g.updateInvoiceById(this.props.userData.token,this.props.invoiceData.invoiceId,n).then((function(e){t.setState({customer:e.customerId})}))}}},{key:"addProductHandler",value:function(e){var t=this,n=0;this.props.products.forEach((function(t){t.id===e&&(n=t.price)}));var a={products:[].concat(Object(N.a)(this.state.products),[{id:e,quantity:1,uniqId:this.state.products.length,price:n,totalPrice:n}])};if("add"===this.pageMod)this.setState(a);else{var r={quantity:1,productId:e,invoiceId:this.props.invoiceData.invoiceId};g.setItemToInvoice(this.props.userData.token,r).then((function(){t.setState(a)}))}}},{key:"quantityHandler",value:function(e,t){var n=this.state.products.map((function(n){return n.uniqId===t&&(n.quantity=e.target.value>0?e.target.value:1,n.totalPrice=n.price*n.quantity),n}));"add"===this.pageMod?this.setState({products:Object(N.a)(n)}):this.updateInvoiceAndItemsHandler("quantity",n)}},{key:"deleteProductHandler",value:function(e){var t=this,n={products:Object(N.a)(this.state.products.filter((function(t){return t.uniqId!==e})))};if("add"===this.pageMod)this.setState(n);else{var a=this.state.products.filter((function(t){return t.uniqId===e}))[0];g.deleteItemById(this.props.userData.token,this.props.invoiceData.invoiceId,a.itemId).then((function(){return t.setState(n)}))}}},{key:"setProductItemInList",value:function(){var e=this,t=[];return this.state.products.forEach((function(n){e.props.products.forEach((function(a){if(a.id===n.id){var o=r.a.createElement(D,{product:a,key:n.id+"/"+1e4*Math.random(),deleteProductHandler:e.deleteProductHandler,quantityHandler:e.quantityHandler,itemOptions:n});t.push(o)}}))})),t}},{key:"discountHandler",value:function(e){var t=this;if("add"===this.pageMod)this.setState({discount:e.target.value});else{var n=e.target.value,a={discount:n,total:this.state.totalInvoicePrice};g.updateInvoiceById(this.props.userData.token,this.props.invoiceData.invoiceId,a).then((function(){return t.setState({discount:n})}))}}},{key:"addInvoice",value:function(e){var t=this;if(e.preventDefault(),this.state.products.length&&this.state.customer){var n={customerId:this.state.customer,createdById:this.props.userData.userId,discount:this.state.discount,total:this.state.totalInvoicePrice};g.setInvoice(this.props.userData.token,n).then((function(e){t.state.products.forEach((function(n){var a={quantity:n.quantity,productId:n.id,invoiceId:e.id};g.setItemToInvoice(t.props.userData.token,a).then((function(){return t.props.history.push("/home")}))}))}))}}},{key:"setAddButton",value:function(){if("add"===this.pageMod)return r.a.createElement("button",{className:"btn btn-add-btn",onClick:this.addInvoice},"Add invoice")}},{key:"setCancelButton",value:function(){var e=this;return"add"===this.pageMod?r.a.createElement(h.b,{to:"/home"},r.a.createElement("button",{className:"btn btn-home-delete ml-2"},"Cancel")):r.a.createElement("button",{className:"btn btn-home-delete ml-2",onClick:function(t){t.preventDefault(),e.setState({redirect:!0})}},"Cancel")}},{key:"updateInvoiceAndItemsHandler",value:function(e,t){var n=this,a={customerId:this.state.customer,createdById:this.props.userData.userId,discount:this.state.discount,total:this.state.totalInvoicePrice};"quantity"===e&&(a={total:this.state.totalInvoicePrice}),g.updateInvoiceById(this.props.userData.token,this.props.invoiceData.invoiceId,a).then((function(a){n.state.products.forEach((function(a){var r={quantity:a.quantity,productId:a.id,invoiceId:n.props.invoiceData.invoiceId};g.updateItemById(n.props.userData.token,n.props.invoiceData.invoiceId,a.itemId,r).then((function(a){"done"===e?n.props.history.push("/home"):"quantity"===e&&n.setState({products:Object(N.a)(t)})}))}))}))}},{key:"setEditState",value:function(){var e=this;g.getInvoiceById(this.props.userData.token,this.props.invoiceData.invoiceId).then((function(t){g.getItemsOfInvoice(e.props.userData.token,e.props.invoiceData.invoiceId).then((function(n){var a=[];n.forEach((function(t,n){var r=e.props.products.filter((function(e){return t.productId===e.id}))[0],o={id:t.productId,quantity:t.quantity,uniqId:n,price:r?r.price:0,totalPrice:r?r.price*t.quantity:0,itemId:t.id};a.push(o)})),a.length&&a[0].totalPrice>0&&e.setState({customer:t.customerId,products:a,discount:t.discount})}))}))}},{key:"render",value:function(){return this.state.products.length||"edit"!==this.pageMod||this.setEditState(),this.state.redirect&&this.updateInvoiceAndItemsHandler("done"),r.a.createElement("form",null,r.a.createElement("div",{className:"row mb-3"},r.a.createElement("div",{className:"col-12 text-left"},r.a.createElement("div",{className:"total ts-2 h3"},"Total price: ",this.state.totalInvoicePrice))),r.a.createElement("div",{className:"row mb-3"},r.a.createElement(O,{customers:this.props.customers,customerHandler:this.customerHandler,pageMod:this.props.pageMod,invoiceData:this.props.invoiceData,customerId:this.state.customer})),r.a.createElement(x,{products:this.props.products,addProductHandler:this.addProductHandler}),r.a.createElement("div",{className:"row"},this.setProductItemInList()),r.a.createElement("div",{className:"row justify-content-between mt-3 align-items-end"},r.a.createElement("div",{className:"col-lg-5 col-md-5 col-sm-12 text-left"},r.a.createElement("label",{htmlFor:"discount-input"},"Discount"),r.a.createElement("input",{type:"text",className:"form-control",id:"discount-input",placeholder:"Discount in %",onChange:this.discountHandler,value:0===this.state.discount?"":this.state.discount})),r.a.createElement("div",{className:"col-lg-5 col-md-5 col-sm-12 text-right add-invoice-form-btn"},this.setAddButton(),this.setCancelButton())))}}]),n}(r.a.Component),C=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).props=void 0,a.token=void 0,a.pageMode=void 0,a.userId=void 0,a.state=void 0,a.invoiceData=void 0,a.token=e.location.state.token,a.pageMode=e.location.state.mode,a.userId=e.location.state.userId,a.invoiceData=e.location.state.invoiceData||{},a.state={customers:[],products:[]},a}return Object(c.a)(n,[{key:"setSelectOptions",value:function(){var e=this;g.getCustomers(this.token).then((function(t){return g.getProducts(e.token).then((function(n){return e.setState({customers:t,products:n})}))}))}},{key:"render",value:function(){return this.state.customers.length||this.setSelectOptions(),r.a.createElement("div",{className:"home-bg"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"row register-block bg-forms rounded text-white text-center justify-content-center p-4"},r.a.createElement("div",{className:"col-12"},r.a.createElement(P,{customers:this.state.customers,products:this.state.products,userData:{userId:this.userId,token:this.token},history:this.props.history,pageMod:this.pageMode,invoiceData:this.invoiceData})))))}}]),n}(r.a.Component),T=n(13),S=(n(41),n(42),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).history=void 0,a.state=void 0,a.cookie=void 0,a.stateHandler=a.stateHandler.bind(Object(u.a)(a)),a.cookie=function(){var e=/^auth=/,t=decodeURI(document.cookie).split("; ").filter((function(t){if(e.test(t))return t}));return t.length?JSON.parse(t.join().split("=")[1]):{}}(),a.state={isAuth:a.cookie!=={}&&a.cookie.isAuth,userId:a.cookie!=={}?a.cookie.userId:"",accessToken:a.cookie!=={}?a.cookie.accessToken:""},a}return Object(c.a)(n,[{key:"stateHandler",value:function(e){var t={isAuth:e.isAuth,userId:e.userId,accessToken:e.accessToken};!function(e,t,n,a,r){var o=encodeURI(e)+"="+encodeURI(t);if(n){var s=new Date(n,a-1,r);o+="; expires="+encodeURI(s.toUTCString())}document.cookie=o}("auth",JSON.stringify(t),2100,10,1),this.setState(t)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(h.a,{basename:"/test-task-invoice"},r.a.createElement(T.d,null,r.a.createElement(T.b,{exact:!0,path:"/"},r.a.createElement(T.a,{to:"/login"})),r.a.createElement(T.b,{path:"/login"},this.state.isAuth?r.a.createElement(T.a,{to:"/home"}):r.a.createElement(y,{stateHandler:this.stateHandler})),r.a.createElement(T.b,{path:"/register",component:I}),r.a.createElement(T.b,{path:"/add-edit-invoice",component:C}),r.a.createElement(T.b,{path:"/home"},this.state.isAuth?r.a.createElement(j,{userData:this.state,stateHandler:this.stateHandler}):r.a.createElement(T.a,{to:"/login"})))))}}]),n}(r.a.Component));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.464f171d.chunk.js.map